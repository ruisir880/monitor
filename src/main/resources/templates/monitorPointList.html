<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <script type="text/javascript"  src="${ctxPath}/scripts/jquery/jquery-1.7.1.js"></script>
    <link href="${ctxPath}/style/authority/basic_layout.css" rel="stylesheet" type="text/css">
    <link href="${ctxPath}/style/authority/common_style.css" rel="stylesheet" type="text/css">
    <script type="text/javascript"  src="${ctxPath}/scripts/authority/commonAll.js"></script>
    <script type="text/javascript"  src="${ctxPath}/scripts/fancybox/jquery.fancybox-1.3.4.js"></script>
    <script type="text/javascript"  src="${ctxPath}/scripts/fancybox/jquery.fancybox-1.3.4.pack.js"></script>
    <link rel="stylesheet" type="text/css" href="style/authority/jquery.fancybox-1.3.4.css" media="screen"></link>
    <script type="text/javascript"  src="${ctxPath}/scripts/artDialog/artDialog.js?skin=default"></script>
    <title>电力测温智能化管理</title>
    <script type="text/javascript">
        $(document).ready(function(){

            /**编辑   **/
            $("a.edit").fancybox({
                'width' : 733,
                'height' : 530,
                'type' : 'iframe',
                'hideOnOverlayClick' : false,
                'showCloseButton' : false,
                'onClosed' : function() {
                    window.close();
                }
            });
        });

        function search() {
            $.ajax({
                type: "get",
                url: "${ctxPath}/queryMP",
                data: {},
                success: function (result) {
                    $("#mpList tr:not(:first)").empty("");
                    var elem
                    for (var i in result) {
                        elem = result[i]
                        item = '<tr><td>'+elem.monitorPointName
                            +'</td> <td>'+elem.area
                            +'</td> <td>'+elem.address
                            +'</td> <td>'+elem.clientCompany
                            +'</td> <td>'+elem.genTime
                            +'</td><td> <a href="${ctxPath}/monitorPointEdit.html?id=' +elem.id
                            +'" class="edit">编辑</a> <a href="javascript:deleteTerminal(' +elem.id
                            +');" class="edit">删除</a> </td></tr>';
                        $('.table').append(item);

                    }
                }

            })
        }

        function deleteMP(mpId) {
            $.ajax({
                type: "POST",
                url: "${ctxPath}/deleteMP",
                data: {"mpId":mpId
                },
                success: function (result) {
                    if(result == 0){
                        art.dialog({icon:'succeed', title:'友情提示', drag:false, resize:false, content:'删除成功', ok:true,});
                    }else if (result == "2") {
                        art.dialog({icon:'error', title:'友情提示', drag:false, resize:false, content:'检测点下有传感器', ok:true,});
                    }else if (result == "1") {
                        art.dialog({icon:'error', title:'友情提示', drag:false, resize:false, content:'删除失败', ok:true,});
                    }
                }

            })
        }

    </script>
    <style>
        .alt td{ background:black !important;}
    </style>
</head>
<body>
<form id="submitForm" name="submitForm" action="" method="get">
    <div id="container">
        <div class="ui_content">
            <div class="ui_text_indent">
                <div id="box_border">
                    <div id="box_top">搜索</div>
                    <div id="box_bottom">
                        <input type="button" value="查询" class="ui_input_btn01" onclick="search();" />
                    </div>
                </div>
            </div>
        </div>

        <div class="ui_content">
            <div class="ui_tb">
                <table class="table" id="mpList" cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
                    <tr>
                        </th>
                        <th>名称</th>
                        <th>区域</th>
                        <th>地址</th>
                        <th>合作公司</th>
                        <th>建立时间</th>
                        <th>操作</th>
                    </tr>
                </table>
            </div>
        </div>
    </div>
</form>

</body>
</html>
