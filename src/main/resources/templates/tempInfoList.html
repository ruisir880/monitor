<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <script type="text/javascript"  src="${ctxPath}/scripts/jquery/jquery-1.7.1.js"></script>
    <link href="${ctxPath}/style/authority/basic_layout.css" rel="stylesheet" type="text/css">
    <link href="${ctxPath}/style/authority/common_style.css" rel="stylesheet" type="text/css">
    <script type="text/javascript"  src="${ctxPath}/scripts/authority/commonAll.js"></script>
    <script type="text/javascript"  src="${ctxPath}/scripts/fancybox/jquery.fancybox-1.3.4.js"></script>
    <script type="text/javascript"  src="${ctxPath}/scripts/fancybox/jquery.fancybox-1.3.4.pack.js"></script>
    <link rel="stylesheet" type="text/css" href="style/authority/jquery.fancybox-1.3.4.css" media="screen"></link>
    <script type="text/javascript"  src="${ctxPath}/scripts/artDialog/artDialog.js?skin=default"></script>
    <script type="text/javascript"  src="${ctxPath}/scripts/sensor.js"></script>
    <title>电力测温智能化管理</title>
    <script type="text/javascript">
        var currentPage;
        var totalPage;

        /** 模糊查询来电用户  **/
        function search(){
            var jumpNumTxt = 1;
            if($("#jumpNumTxt").val())
                jumpNumTxt=$("#jumpNumTxt").val();
            var startTime = $("#startTime").val();
            var endTime = $("#endTime").val();
            var state = $("#state").val();
            var endTime = $("#endTime").val();
            var monitorPoint = $("#monitorPoint").val();
            $.ajax({
                type: "GET",
                url: "checkTempInfo",
                data: {"monitorPointId":monitorPoint,
                    "terminalId":$("#terminal").val(),
                    "startTime":startTime,
                    "endTime":endTime,
                    "state":state,
                    page:jumpNumTxt
                },
                success: function (result) {
                    initHtml()
                    var item;
                    var elem;
                    var  sensorname;
                    var terminalName;
                    currentPage= result.page + 1
                    totalPage = result.totalPage
                    $("#totalCount").append(result.totalCount)
                    $("#page").append(currentPage)
                    for (var i in result.tempVO.sensorVOList) {
                        sensorname = result.tempVO.sensorVOList[i].sensorName
                        terminalName = result.tempVO.sensorVOList[i].terminalName
                        for(var j in result.tempVO.sensorVOList[i].tempHistoryVOList) {
                            elem = result.tempVO.sensorVOList[i].tempHistoryVOList[j]
                            item = "<tr><td>"+sensorname
                                +"</td> <td>"+terminalName
                                    +"</td> <td>"+elem.genTime
                                    +"</td> <td>"+elem.temp
                                    +"</td> <td>"+result.tempVO.sensorVOList[i].threshold
                                    +"</td> </tr>";
                            $('.table').append(item);
                        }
                    }
                }
                })
        }
        function initHtml() {
            $("#temoInfoTable tr:not(:first)").empty("");
            $("#totalCount").empty()
            $("#page").empty()
        }

        function jumpNextPage(){
            if(currentPage < totalPage){
                $("#jumpNumTxt").val(currentPage+1)
                search();
            }
        }

        function jumpLastPage(){
            if(currentPage>1){
                $("#jumpNumTxt").val(currentPage-1)
                search();
            }
        }


        /** 输入页跳转 **/
        function jumpInputPage(pageNumber){
            // 如果“跳转页数”不为空
            if($("#jumpNumTxt").val() != ''){
                var pageNum = parseInt($("#jumpNumTxt").val());
                // 如果跳转页数在不合理范围内，则置为1
                if(pageNum<1 | pageNum>pageNumber){
                    art.dialog({icon:'error', title:'友情提示', drag:false, resize:false, content:'请输入合适的页数', ok:true,});
                    pageNum = 1;
                }
                $("#submitForm").attr("action", "house_list.html?page=" + pageNum).submit();
            }else{
                // “跳转页数”为空
                art.dialog({icon:'error', title:'友情提示', drag:false, resize:false, content:'请输入合适的页数', ok:true,});
                $("#submitForm").attr("action", "house_list.html?page=" + 1).submit();
            }
        }
    </script>
    <style>
        .alt td{ background:black !important;}
    </style>
</head>
<body>
<form id="tempInfoForm" name="tempInfoForm" action="" method="post">
    <div id="container">
        <div class="ui_content">
            <div class="ui_text_indent">
                <div id="box_border">
                    <div id="box_top">搜索</div>
                    <div id="box_center">
                        监测点：&nbsp;&nbsp;
                        <select name="monitorPoint" id="monitorPoint" style="width: 200px;height: 30px;margin: 2px 2px 2px 5px;" onchange="monitorPointSelect();">
                            @if(!isEmpty(monitorPointList)){
                            @for(monitorPoint in monitorPointList){
                            <option value="${monitorPoint.id}">监测点:${monitorPoint.name}</option>
                            @}
                            @}
                        </select>
                        &nbsp;&nbsp;
                        终端：&nbsp;&nbsp;
                        <select name="terminal" id="terminal" style="width: 200px;height: 30px;margin: 2px 2px 2px 5px;">
                            <option value="">--请选择--</option>
                            @if(!isEmpty(monitorPointList)){
                            @for(terminal in monitorPointList[0].terminalInfoList){
                            <option value=${terminal.id}>终端:${terminal.terminalId}</option>
                            @}
                            @}
                        </select>
                        &nbsp;&nbsp;
                       状态
                        <select name="state" id="state" class="ui_select01">
                            <option value="all">全部</option>
                            <option value="noWarn">无告警</option>
                            <option value="warn">告警</option>
                        </select>

                        时间段：&nbsp;&nbsp;<input type="datetime-local" id="startTime" name="startTime" class="ui_input_txt02_date" />
                        到&nbsp;&nbsp;<input type="datetime-local" id="endTime" name="endTime" class="ui_input_txt02_date" />
                    </div>
                    <div id="box_bottom">
                        <input type="button" value="查询" class="ui_input_btn01" onclick="search();" />
                    </div>
                </div>
            </div>
        </div>
        <div class="ui_content">
            <div class="ui_tb">
                <table class="table" id="temoInfoTable" cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
                    <tr>
                        </th>
                        <th>传感器名</th>
                        <th>终端名</th>
                        <th>时间</th>
                        <th>温度</th>
                        <th>传感器阈值</th>
                    </tr>
                </table>
            </div>
            <div class="ui_tb_h30">
                <div class="ui_flt" style="height: 30px; line-height: 30px;">
                    共有
                    <span id="totalCount" class="ui_txt_bold04"></span>
                    条记录，当前第
                    <span id="page" class="ui_txt_bold04">
                    </span>
                    页
                </div>
                <div class="ui_frt">
                    <!--    如果是第一页，则只显示下一页、尾页 -->
                    <input type="button" value="上一页" class="ui_input_btn01" onclick="jumpLastPage()"  />
                    <input type="button" value="下一页" class="ui_input_btn01" onclick="jumpNextPage()" />

                    转到第<input type="text" id="jumpNumTxt" class="ui_input_txt01" />页
                    <input type="button" class="ui_input_btn01" value="跳转" onclick="jumpInputPage(9);" />
                </div>
            </div>
        </div>
    </div>
</form>

</body>
</html>
